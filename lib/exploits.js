/*
  Copyright Jesús Pérez <jesusprubio@gmail.com>

  This code may only be used under the MIT license found at
  https://opensource.org/licenses/MIT.
*/

'use strict';

// https://developer.shodan.io/api/exploits/rest

const utils = require('./utils');

// Optional parameters for each function.
const optionalParams = {
  search: ['facets', 'page'],
  count: ['facets'],
};
// Part of all urls.
const apiSection = 'exploits';


function req(subPath, query, opts = {}) {
  let partialUrl = `/api/${subPath}?`;

  if (!query) { return Promise.reject(utils.createErrMandatory('query')); }

  partialUrl = utils.addParam(partialUrl, 'query', query);
  partialUrl = utils.addOptionals(partialUrl, optionalParams[subPath], opts);

  return utils.apiRequest(apiSection, partialUrl, opts.timeout);
}


module.exports.search = (query, opts = {}) => req('search', query, opts);


module.exports.count = (query, opts = {}) => req('count', query, opts);
